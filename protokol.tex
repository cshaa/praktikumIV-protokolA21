% !TEX program = xelatex

% Nejlepší zážitek zaručí:
%
% TeX distribuce: texlive-full
%
% Editor:
%   VS Code s doplňky
%       * LaTeX Workshop
%       * LaTeX Utilities
%       * Gnuplot
%
% Další závislosti:
%   latexmk
%   bibtex
%   gnuplot


% Jak používat:
% Zkompilovat: make
% Gnuplot: make gnuplot
% Vyčistit: make clean


% Základní balíčky
\documentclass[10pt,a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage[czech]{babel}
\usepackage{graphicx}
\usepackage{lmodern}
\usepackage{amsmath}
\usepackage{hyperref}
\usepackage{gensymb}
\usepackage[top = 1.5cm, bottom = 1.5cm, left = 1.5cm, right = 1.5cm]{geometry}

% Pro titulní stránku
\usepackage{titlesec}
\usepackage{setspace}
\usepackage{framed}
\usepackage{array}

% Vlastní balíčky 
\usepackage{gnuplottex}
\usepackage{epstopdf}
\usepackage{csvsimple}


\renewcommand{\U}[1]{\ensuremath{\,\mathrm{#1}}}
\newcommand{\°}{\degree}

\newcommand{\titjmeno}{Michal Grňo}
\newcommand{\titobor}{FOF}


\newcommand{\titcislo}{A7}
\newcommand{\titnazev}{Pozitronová emisní tomografie}
\newcommand{\titmereni}{7. 10. 2019}
\newcommand{\titodevzdani}{20. 10. 2019}


\begin{document}

\include{titulka}

\section{Pracovní úkoly}
\begin{enumerate}
    \item Poté, co vyučující umístí silnější zářič ${}^{22}$Na do stojánku, změřte úhlové rozdělení koincidencí v oblasti úhlů potřebné pro nalezení polohy zářiče, doba měření 20s. Vysvětlete tvar naměřeného úhlového rozdělení, získané poznatky využijte při domácím zpracování.

    \item Změřte četnost koincidencí pro úhly $\phi$ = 60°, 90°, 120° bez plechu a 120° s Pb plechem mezi detektory, doba měření 100s. Vysvětlete pozorované četnosti.
    
    \item Poté, co vyučující přidá do krabičky druhý zářič, změřte úhlové rozdělení koincidencí s krokem 5°.
    
    \item Zvolte aspoň 2 další vhodné úhly otočení krabičky $\psi$ a opakujte měření 3).
    
    \item Narýsujte přímky spojující detektory do obrázku připraveného u úlohy a odečtěte polohu průsečíku - polohu zářiče vůči krabičce. Pozn.: Při volbě otočení krabičky $\psi$ se můžete řídit polohou už zakreslených průsečíků.
    
    \item Vzdálenost detektoru od zářiče zakresleného na obrázku porovnejte s měřením skutečné vzdálenosti.
    
    \item Polohy zářičů vůči krabičce určujte pomocí vztahů a metod popsaných v návodu. Podle výsledků zpracování nakreslete obrázky analogické k obrázkům narýsoaným během praktika. Chyby polohy zářičů určete graficky
\end{enumerate}


\section{Teoretická část}
Teorie\cite{DUMMY:1}
\begin{equation*}
    A = 4
    \label{A}
\end{equation*}


\section{Výsledky měření}
Naměřil jsem 3.


\begin{figure}[p]
    \centering
    \begin{gnuplot}[terminal=epslatex,terminaloptions=color]
        data = 'data/CO_GRNO.PRN'
        set xrange [2500:2000] reverse
        set xlabel "$k \\; [\\U{cm^{-1}}]$"
        set ylabel "$T$"
        plot \
            data using ($1 >= 2385 ? $1 : 1/0):2 w l lc black notitle, \
            data using (2385 >= $1 && $1 >= 2349 ? $1 : 1/0):2 w l t "$CO_2, P$", \
            data using (2349 >= $1 && $1 >= 2290 ? $1 : 1/0):2 w l t "$CO_2, R$", \
            data using (2290 >= $1 && $1 >= 2238 ? $1 : 1/0):2 w l lc black notitle, \
            data using (2238 >= $1 && $1 >= 2143 ? $1 : 1/0):2 w l t "$CO, P$", \
            data using (2143 >= $1 && $1 >= 2033 ? $1 : 1/0):2 w l t "$CO, R$", \
            data using (2033 >= $1 ? $1 : 1/0):2 w l lc black notitle
    \end{gnuplot}
    \caption{Měření transmitance CO.}
    \label{co-trans}
\end{figure}

\begin{figure}[p]
    \centering
    \begin{gnuplot}[terminal=epslatex,terminaloptions={color size 15cm,10cm}]

        load 'matlib.cfg'
        h = 6.62607015e-34
        c = 299792458

        LF_File = 'data/co_tab_grno.txt'
        LF_Columns = 6
        load 'loadfile.cfg'
        N = LF_Rows - 1

        stred_i = -1

        array Energie[N]
        do for [i = 1:N] {
            Energie[i] = real(LF_Col1[i+1]) * 100 * h * c
            if (stred_i == -1 && Energie[i] >= 214500*h*c) {
                stred_i = i
            }
        }

        array R[stred_i - 1]
        array P[N - stred_i + 1]
        do for [i = 1:N] {
            if (i < stred_i) { R[stred_i - i] = Energie[i] }
            else { P[i - stred_i + 1] = Energie[i] }
        }

        set multiplot layout 2,1

        set yrange [4:4.5]
        set ytics 0.1
        set xlabel "$J$"
        set ylabel "$P_J, R_J \\; [10^{-20} \\U{J}]$"
        set key outside
        set key right center

        plot sample \
            [i=1:|P|:1] '+' using (i):(P[i]*1e20) t "$P_J$", \
            [i=1:|R|:1] '+' using (i-1):(R[i]*1e20) t "$R_J$"

        N = min(|R|+1, |P|)

        array X1[N]
        array Y1[N]
        array Y1_scaled[N]

        do for [i=2:N] {
            X1[i] = (2*i-1)**2
            Y1[i] = (R[i-1] - P[i]) / ( (2*i-1) * h)
            Y1_scaled[i] = Y1[i] / 1e11
        }

        M = min(|R|+2, |P|-1)

        array X2[M]
        array Y2[M]
        array Y2_scaled[M]

        do for [i=3:M] {
            X2[i] = (2*i-1)**2
            Y2[i] = (R[i-2] - P[i+1]) / ( (2*i-1) * h)
            Y2_scaled[i] = Y2[i] / 1e11
        }

        set xtics rotate
        set yrange [-1.15:-1.12]
        set ytics   0.01
        set xlabel "$\\left(2J + 1\\right)^2$"
        set ylabel "$\\left(P_a - R_b\\right)/\\mathrm{h}\\left(2J + 1\\right) \\; [10^{11}\\U{s^{-1}}]$"
        plot sample \
            [i=2:N:1] '+' using (X1[i]):(Y1_scaled[i]) t "$R_J - P_J$", \
            [i=3:M:1] '+' using (X2[i]):(Y2_scaled[i]) t "$R_{J-1} - P_{J+1}$", \

    \end{gnuplot}
    \caption{Energie pásů P a R v CO.}
    \label{co-fit}
\end{figure}

\begin{figure}[p]
    \centering
    \begin{gnuplot}[terminal=epslatex,terminaloptions=color]
        data = 'data/VZDUCH_GRNO.PRN'
        set key left top
        set xrange [4500:500] reverse
        set xlabel "$k \\; [\\U{cm^{-1}}]$"
        set ylabel "$T$"
        plot \
            data using ($1 >= 4000 ? $1 : 1/0):2 w l lc black notitle, \
            data using (4000 >= $1 && $1 >= 3500 ? $1 : 1/0):2 w l t "$H_2O$, 1. harm.", \
            data using (3500 >= $1 && $1 >= 2400 ? $1 : 1/0):2 w l lc black notitle, \
            data using (2400 >= $1 && $1 >= 2240 ? $1 : 1/0):2 w l t "$CO_2$, 1. harm.", \
            data using (2240 >= $1 && $1 >= 2050 ? $1 : 1/0):2 w l lc black notitle, \
            data using (2050 >= $1 && $1 >= 1330 ? $1 : 1/0):2 w l t "$H_2O$, 2. harm.", \
            data using (1330 >= $1 && $1 >= 705  ? $1 : 1/0):2 w l lc black notitle, \
            data using (705 >= $1 && $1 >= 670.5 ? $1 : 1/0):2 w l t "$CO_2, P$, 2. harm." lc 'red', \
            data using (670.5 >= $1 && $1 >= 666 ? $1 : 1/0):2 w l t "$CO_2, Q$, 2. harm.", \
            data using (666 >= $1 && $1 >= 620 ? $1 : 1/0):2 w l t "$CO_2, R$, 2. harm.", \
            data using (620 >= $1 ? $1 : 1/0):2 w l lc black notitle
    \end{gnuplot}
    \caption{Měření transmitance vzduchu}
    \label{vzduch-trans}
\end{figure}



\pagebreak


\section{Diskuse}
Bylo to špatně protože \eqref{A} 


\section{Závěr}
Bylo to hezké. assadfasd

\section{Literatura}
\bibliography{literatura} 
\bibliographystyle{ieeetr}

 
\end{document}